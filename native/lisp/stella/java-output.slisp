;;; -*- Mode: Lisp; Package: STELLA; Syntax: COMMON-LISP; Base: 10 -*-

#|--------------------------------------------------------------------------+
 |                                                                          |
 |  COPYRIGHT (C) UNIVERSITY OF SOUTHERN CALIFORNIA, 1996-2000              | 
 |  University of Southern California, Information Sciences Institute       |
 |  4676 Admiralty Way                                                      |
 |  Marina Del Rey, California 90292                                        |
 |                                                                          |
 |  This software was developed under the terms and conditions of Contract  |
 |  No. N00014-94-C-0245 between the Defense Advanced Research Projects     |
 |  Agency and the University of Southern California, Information Sciences  | 
 |  Institute.  Use and distribution of this software is further subject    |
 |  to the provisions of that contract and any other agreements developed   |
 |  between the user of the software and the University of Southern         |
 |  California, Information Sciences Institute.  It is supplied "AS IS",    |
 |  without any warranties of any kind.  It is furnished only on the basis  |
 |  that any party who receives it indemnifies and holds harmless the       |
 |  parties who furnish and originate it against any claims, demands, or    |
 |  liabilities connected with using it, furnishing it to others or         |
 |  providing it to a third party.  THIS NOTICE MUST NOT BE REMOVED FROM    |
 |  THE SOFTWARE, AND IN THE EVENT THAT THE SOFTWARE IS DIVIDED, IT SHOULD  |
 |  BE ATTACHED TO EVERY PART.                                              |
 |                                                                          |
 +--------------------------------------------------------------------------|#

(CL:IN-PACKAGE "STELLA")

;;; Auxiliary variables:

(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_CLASS NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_EXCEPTION_CLASS NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_NAMED_STATEMENT NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_STATEMENTS NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_IDENT NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_EOL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_LITERAL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_COMMENT NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_SYMBOL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_CATCH NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_THROW NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_UNWIND_PROTECT NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_HANDLER_CASE NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_SIGNAL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_VERBATIM NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_CAST NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_GLOBAL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_SPECIAL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_TYPE NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_PROGN NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_BLOCK NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_RETURN NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_MAKE NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCALL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_CODE_CALL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_ASSIGN NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_BREAK NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_CONTINUE NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_COND NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_CASE NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_IF NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_WHEN NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_UNLESS NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_LOOP NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_WHILE NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_FOREACH NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_SLOT_VALUE NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_SLOT_VALUE_SETTER NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_UNARY_OP NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_BINARY_OP NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_TERNARY_OP NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION_CALL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_CALL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_ACTUALS NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_MAKE_ARRAY NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_ARRAY_INITIALIZER NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_ANONYMOUS_ARRAY NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_AREF NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_PRINT_STREAM NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_PRINT_NATIVE_STREAM NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_DECLARATIONS NULL)
(CL:DEFVAR SGT-JAVA-OUTPUT-STELLA-CONS NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION_POINTER NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_POINTER NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_SETTER_CALL NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_NEW NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_STANDARD_OUT NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-JAVA_STANDARD_ERROR NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-STARTUP-JAVA-OUTPUT NULL)
(CL:DEFVAR SYM-JAVA-OUTPUT-STELLA-METHOD-STARTUP-CLASSNAME NULL)

;;; Forward declarations:

(CL:DECLAIM
 (CL:SPECIAL *MODULE* NULL-CHARACTER EOL *CURRENT-STREAM* *STELLA-MODULE*))

;;; (DEFSPECIAL *JAVA-INDENT-CHARS* ...)

(CL:PROGN (CL:DEFVAR *JAVA-INDENT-CHARS* 0) (CL:DECLAIM (CL:TYPE CL:FIXNUM *JAVA-INDENT-CHARS*)))

;;; (DEFGLOBAL *JAVA-STELLA-PACKAGE-MAPPING* ...)

(CL:DEFVAR *JAVA-STELLA-PACKAGE-MAPPING* NULL)

;;; (DEFUN (JAVA-STELLA-PACKAGE STRING) ...)

(CL:DEFUN JAVA-STELLA-PACKAGE ()
  (CL:LET* ((STELLAPACKAGE (JAVA-PACKAGE *STELLA-MODULE*)))
   (CL:DECLARE (CL:TYPE CL:SIMPLE-STRING STELLAPACKAGE))
   (CL:IF (CL:NOT (CL:EQ STELLAPACKAGE STELLA::NULL-STRING))
    (CL:RETURN-FROM JAVA-STELLA-PACKAGE STELLAPACKAGE)
    (CL:RETURN-FROM JAVA-STELLA-PACKAGE "stella"))))

;;; (DEFUN JAVA-OUTPUT-PARSE-TREE ...)

(CL:DEFUN JAVA-OUTPUT-PARSE-TREE (CONSTREE)
  (CL:LET* ((*JAVA-INDENT-CHARS* 0))
   (CL:DECLARE (CL:SPECIAL *JAVA-INDENT-CHARS*))
   (CL:DECLARE (CL:TYPE CL:FIXNUM *JAVA-INDENT-CHARS*))
   (INSERT-AT *JAVA-STELLA-PACKAGE-MAPPING* (WRAP-STRING "STELLAROOT")
    (WRAP-STRING (JAVA-STELLA-PACKAGE)))
   (JAVA-OUTPUT-STATEMENT CONSTREE))
  :VOID)

;;; (DEFUN JAVA-BUMP-INDENT ...)

(CL:DEFUN JAVA-BUMP-INDENT ()
  (CL:SETQ *JAVA-INDENT-CHARS* (CL:+ *JAVA-INDENT-CHARS* 2))
  :VOID)

;;; (DEFUN JAVA-UNBUMP-INDENT ...)

(CL:DEFUN JAVA-UNBUMP-INDENT ()
  (CL:SETQ *JAVA-INDENT-CHARS* (CL:- *JAVA-INDENT-CHARS* 2))
  :VOID)

;;; (DEFUN JAVA-INDENT ...)

(CL:DEFUN JAVA-INDENT ()
  (CL:LET*
   ((D NULL-INTEGER) (ITER-000 1) (UPPER-BOUND-000 *JAVA-INDENT-CHARS*)
    (UNBOUNDED?-000 (NULL? UPPER-BOUND-000)))
   (CL:DECLARE (CL:TYPE CL:FIXNUM ITER-000 UPPER-BOUND-000 D))
   (CL:LOOP WHILE (CL:OR UNBOUNDED?-000 (CL:<= ITER-000 UPPER-BOUND-000))
    DO (CL:PROGN (CL:SETQ D ITER-000) (CL:SETQ ITER-000 (CL:1+ ITER-000)))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " ")))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-STATEMENT ...)

(CL:DEFUN JAVA-OUTPUT-STATEMENT (STATEMENT)
  (CL:COND
   ((CL:EQ (SAFE-PRIMARY-TYPE STATEMENT) SGT-JAVA-OUTPUT-STELLA-CONS)
    (CL:PROGN
     (CL:WHEN (CL:EQ STATEMENT NIL)
      (CL:RETURN-FROM JAVA-OUTPUT-STATEMENT))
     (CL:IF
      (CL:OR (CONS? (%%VALUE STATEMENT)) (CL:EQ (%%VALUE STATEMENT) NULL))
      (CL:PROGN (JAVA-OUTPUT-STATEMENT (%%VALUE STATEMENT))
       (JAVA-OUTPUT-STATEMENT (%%REST STATEMENT)))
      (CL:LET* ((TEST-VALUE-000 (%%VALUE STATEMENT)))
       (CL:COND
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_CLASS)
         (JAVA-OUTPUT-CLASS (%%REST STATEMENT) FALSE))
        ((CL:EQ TEST-VALUE-000
          SYM-JAVA-OUTPUT-STELLA-JAVA_EXCEPTION_CLASS)
         (JAVA-OUTPUT-CLASS (%%REST STATEMENT) TRUE))
        ((CL:EQ TEST-VALUE-000
          SYM-JAVA-OUTPUT-STELLA-JAVA_NAMED_STATEMENT)
         (JAVA-OUTPUT-NAMED-STATEMENT (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_STATEMENTS)
         (JAVA-OUTPUT-STATEMENTS (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_IDENT)
         (JAVA-OUTPUT-IDENTIFIER (%%VALUE (%%REST STATEMENT))))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_EOL)
         (JAVA-OUTPUT-IDENTIFIER (%%VALUE (%%REST STATEMENT))))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_LITERAL)
         (JAVA-OUTPUT-LITERAL (%%VALUE (%%REST STATEMENT))))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_COMMENT)
         (JAVA-OUTPUT-COMMENT (%%VALUE (%%REST STATEMENT))))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_SYMBOL)
         (JAVA-OUTPUT-LITERAL (%%VALUE (%%REST STATEMENT))))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_CATCH)
         (JAVA-OUTPUT-CATCH (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_THROW)
         (JAVA-OUTPUT-THROW (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_UNWIND_PROTECT)
         (JAVA-OUTPUT-UNWIND-PROTECT (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_HANDLER_CASE)
         (JAVA-OUTPUT-HANDLER-CASE (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_SIGNAL)
         (JAVA-OUTPUT-SIGNAL (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_VERBATIM)
         (JAVA-OUTPUT-VERBATIM (%%VALUE (%%REST STATEMENT))))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_CAST)
         (JAVA-OUTPUT-CAST (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_GLOBAL)
         (JAVA-OUTPUT-GLOBAL-DEFINITION (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_SPECIAL)
         (JAVA-OUTPUT-SPECIAL-DEFINITION (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_TYPE)
         (JAVA-OUTPUT-TYPE-EXPRESSION (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_PROGN)
         (JAVA-OUTPUT-PROGN (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_BLOCK)
         (JAVA-OUTPUT-BLOCK (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_RETURN)
         (JAVA-OUTPUT-RETURN (%%VALUE (%%REST STATEMENT))))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_MAKE)
         (JAVA-OUTPUT-MAKE (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCALL)
         (JAVA-OUTPUT-FUNCALL (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000
          SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_CODE_CALL)
         (JAVA-OUTPUT-METHOD-CODE-CALL (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_ASSIGN)
         (JAVA-OUTPUT-ASSIGNMENT (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_BREAK)
         (JAVA-OUTPUT-BREAK (%%VALUE (%%REST STATEMENT))))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_CONTINUE)
         (JAVA-OUTPUT-CONTINUE (%%VALUE (%%REST STATEMENT))))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_COND)
         (JAVA-OUTPUT-COND (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_CASE)
         (JAVA-OUTPUT-CASE (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_IF)
         (JAVA-OUTPUT-IF (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_WHEN)
         (JAVA-OUTPUT-WHEN (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_UNLESS)
         (JAVA-OUTPUT-UNLESS (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_LOOP)
         (JAVA-OUTPUT-LOOP (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_WHILE)
         (JAVA-OUTPUT-WHILE (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_FOREACH)
         (JAVA-OUTPUT-FOREACH (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_SLOT_VALUE)
         (JAVA-OUTPUT-SLOT-VALUE (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000
          SYM-JAVA-OUTPUT-STELLA-JAVA_SLOT_VALUE_SETTER)
         (JAVA-OUTPUT-SLOT-VALUE-SETTER (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_UNARY_OP)
         (JAVA-OUTPUT-UNARY-OPERATOR (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_BINARY_OP)
         (JAVA-OUTPUT-BINARY-OPERATOR (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_TERNARY_OP)
         (JAVA-OUTPUT-TERNARY-OPERATOR (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION_CALL)
         (JAVA-OUTPUT-FUNCTION-CALL (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_CALL)
         (JAVA-OUTPUT-METHOD-CALL (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_ACTUALS)
         (JAVA-OUTPUT-ACTUAL-PARAMETERS (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_MAKE_ARRAY)
         (JAVA-OUTPUT-MAKE-ARRAY (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000
          SYM-JAVA-OUTPUT-STELLA-JAVA_ARRAY_INITIALIZER)
         (JAVA-OUTPUT-ARRAY (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000
          SYM-JAVA-OUTPUT-STELLA-JAVA_ANONYMOUS_ARRAY)
         (JAVA-OUTPUT-ANONYMOUS-ARRAY (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_AREF)
         (JAVA-OUTPUT-AREF (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD)
         (JAVA-OUTPUT-METHOD (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION)
         (JAVA-OUTPUT-METHOD (%%REST STATEMENT)))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_PRINT_STREAM)
         (JAVA-OUTPUT-PRINT-STREAM (%%REST STATEMENT) FALSE))
        ((CL:EQ TEST-VALUE-000
          SYM-JAVA-OUTPUT-STELLA-JAVA_PRINT_NATIVE_STREAM)
         (JAVA-OUTPUT-PRINT-STREAM (%%REST STATEMENT) TRUE))
        ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_DECLARATIONS)
         (JAVA-OUTPUT-DECLARATIONS (%%REST STATEMENT)))
        (CL:T
         (CL:LET* ((STREAM-000 (NEW-OUTPUT-STRING-STREAM)))
          (%%PRINT-STREAM (%OUTPUT-STRING-STREAM.NATIVE-STREAM STREAM-000)
           "`" TEST-VALUE-000 "' is not a valid case option")
          (CL:ERROR
           (NEW-STELLA-EXCEPTION (THE-STRING-READER STREAM-000))))))))))
   (CL:T
    (CL:WHEN (CL:EQ STATEMENT NULL)
     (CL:RETURN-FROM JAVA-OUTPUT-STATEMENT))
    (JAVA-OUTPUT-LITERAL STATEMENT)))
  :VOID)

;;; (DEFUN JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES ...)

(CL:DEFUN JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES (STATEMENT)
  (CL:WHEN (JAVA-OPERATOR? STATEMENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "("))
  (JAVA-OUTPUT-STATEMENT STATEMENT)
  (CL:WHEN (JAVA-OPERATOR? STATEMENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")"))
  :VOID)

;;; (DEFUN (JAVA-SEPARATE-LAST-CONS CONS OBJECT) ...)

(CL:DEFUN JAVA-SEPARATE-LAST-CONS (CONSLIST)
  (CL:LET*
   ((COPIEDITEMS (COPY-CONS-LIST CONSLIST)) (REVERSEDITEMS NULL)
    (ALLBUTLASTITEM NULL) (LASTITEM NULL))
   (CL:SETQ REVERSEDITEMS (REVERSE COPIEDITEMS))
   (CL:SETQ LASTITEM (%%VALUE REVERSEDITEMS))
   (CL:SETQ ALLBUTLASTITEM (REVERSE (%%REST REVERSEDITEMS)))
   (CL:RETURN-FROM JAVA-SEPARATE-LAST-CONS
    (CL:VALUES ALLBUTLASTITEM LASTITEM))))

;;; (DEFUN JAVA-OUTPUT-IDENTIFIER ...)

(CL:DEFUN JAVA-OUTPUT-IDENTIFIER (IDENTIFIER)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE IDENTIFIER))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((OBJECT OBJECT))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((STRING CL:STRING))
  (CL:DECLARE (CL:TYPE CL:SIMPLE-STRING STRING))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "\""
   (REPLACE-SUBSTRINGS
    (REPLACE-SUBSTRINGS
     (REPLACE-SUBSTRINGS (REPLACE-SUBSTRINGS STRING "\\\\" "\\") "\\\""
      (MAKE-STRING 1 #\"))
     "\\n" (MAKE-STRING 1 #\Linefeed))
    "\\r" (MAKE-STRING 1 #\Return))
   "\"")
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((STRING STRING-WRAPPER))
  (JAVA-OUTPUT-LITERAL (%STRING-WRAPPER.WRAPPER-VALUE STRING))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((STRING MUTABLE-STRING-WRAPPER))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   "new StringBuffer(")
  (JAVA-OUTPUT-LITERAL
   (CL:LET ((S (%MUTABLE-STRING-WRAPPER.WRAPPER-VALUE STRING)))
    (CL:DECLARE (CL:TYPE CL:SIMPLE-STRING S)) (CL:THE CL:SIMPLE-STRING S)))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")")
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((CHARACTER CHARACTER-WRAPPER))
  (CL:CASE (%CHARACTER-WRAPPER.WRAPPER-VALUE CHARACTER)
   (#\'
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "'\\''"))
   (#\\
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "'\\\\'"))
   (#\Linefeed
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "'\\n'"))
   (#\Backspace
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "'\\b'"))
   (#\Tab
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "'\\t'"))
   (#\Return
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "'\\r'"))
   (#\Page
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "'\\f'"))
   (CL:OTHERWISE
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "'"
     (%CHARACTER-WRAPPER.WRAPPER-VALUE CHARACTER) "'")))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((INT INTEGER-WRAPPER))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%INTEGER-WRAPPER.WRAPPER-VALUE INT))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((FLOAT FLOAT-WRAPPER))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%FLOAT-WRAPPER.WRAPPER-VALUE FLOAT))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((BOOLEAN BOOLEAN-WRAPPER))
  (CL:IF (%BOOLEAN-WRAPPER.WRAPPER-VALUE BOOLEAN)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "true")
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    "false"))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-MAKE-ARRAY ...)

(CL:DEFUN JAVA-OUTPUT-MAKE-ARRAY (STATEMENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "new ")
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE STATEMENT)))
  (CL:LET* ((DIMENSION NULL) (ITER-000 (%%REST STATEMENT)))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
    (CL:PROGN (CL:SETQ DIMENSION (%%VALUE ITER-000))
     (CL:SETQ ITER-000 (%%REST ITER-000)))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "[")
    (JAVA-OUTPUT-STATEMENT DIMENSION)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "]")))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-ARRAY ...)

(CL:DEFUN JAVA-OUTPUT-ARRAY (ARRAYELEMENTS)
  (CL:LET* ((LASTELEMENT NULL) (ALLBUTLASTELEMENT NULL))
   (CL:MULTIPLE-VALUE-SETQ (ALLBUTLASTELEMENT LASTELEMENT)
    (SEPARATE-LAST-CONS ARRAYELEMENTS))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "{")
   (CL:LET* ((ELEMENT NULL) (ITER-000 ALLBUTLASTELEMENT))
    (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
     (CL:PROGN (CL:SETQ ELEMENT (%%VALUE ITER-000))
      (CL:SETQ ITER-000 (%%REST ITER-000)))
     (JAVA-OUTPUT-STATEMENT ELEMENT)
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
      ", ")))
   (CL:WHEN (CL:NOT (CL:EQ LASTELEMENT NULL))
    (JAVA-OUTPUT-STATEMENT LASTELEMENT))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}"))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-ANONYMOUS-ARRAY ...)

(CL:DEFUN JAVA-OUTPUT-ANONYMOUS-ARRAY (STATEMENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "new ")
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE STATEMENT)))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " [] ")
  (JAVA-OUTPUT-ARRAY (%%REST STATEMENT))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-AREF ...)

(CL:DEFUN JAVA-OUTPUT-AREF (STATEMENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE STATEMENT))
  (CL:LET* ((DIMENSION NULL) (ITER-000 (%%REST STATEMENT)))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
    (CL:PROGN (CL:SETQ DIMENSION (%%VALUE ITER-000))
     (CL:SETQ ITER-000 (%%REST ITER-000)))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "[")
    (JAVA-OUTPUT-STATEMENT DIMENSION)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "]")))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-SLOT-VALUE ...)

(CL:DEFUN JAVA-OUTPUT-SLOT-VALUE (STATEMENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE STATEMENT))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "."
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST STATEMENT))))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-SLOT-VALUE-SETTER ...)

(CL:DEFUN JAVA-OUTPUT-SLOT-VALUE-SETTER (STATEMENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE STATEMENT))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "."
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST STATEMENT))) " = ")
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST (%%REST STATEMENT))))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-IMPLEMENTS-INTERFACES ...)

(CL:DEFUN JAVA-OUTPUT-IMPLEMENTS-INTERFACES (INTERFACELIST)
  (CL:LET* ((LASTINTERFACE NULL) (ALLBUTLASTINTERFACE NULL))
   (CL:MULTIPLE-VALUE-SETQ (ALLBUTLASTINTERFACE LASTINTERFACE)
    (JAVA-SEPARATE-LAST-CONS INTERFACELIST))
   (CL:LET* ((INTERFACE NULL) (ITER-000 ALLBUTLASTINTERFACE))
    (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
     (CL:PROGN (CL:SETQ INTERFACE (%%VALUE ITER-000))
      (CL:SETQ ITER-000 (%%REST ITER-000)))
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
      (%STRING-WRAPPER.WRAPPER-VALUE INTERFACE) ", ")))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    (%STRING-WRAPPER.WRAPPER-VALUE LASTINTERFACE) " "))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-CLASS ...)

(CL:DEFUN JAVA-OUTPUT-CLASS (CLASSDEF EXCEPTIONCLASS?)
  (CL:WHEN (CL:NOT (CL:EQ (%%VALUE CLASSDEF) NULL))
   (JAVA-OUTPUT-JAVADOC-COMMENT (%%VALUE CLASSDEF) NULL NULL
    "Stella Java Translator" STELLA::NULL-STRING))
  (CL:LET* ((M NULL) (ITER-000 (%%VALUE (%%REST CLASSDEF))))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
    (CL:PROGN (CL:SETQ M (%%VALUE ITER-000))
     (CL:SETQ ITER-000 (%%REST ITER-000)))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     (%STRING-WRAPPER.WRAPPER-VALUE M) " ")))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST (%%REST CLASSDEF))))
   " " (%STRING-WRAPPER.WRAPPER-VALUE (FOURTH CLASSDEF)) " ")
  (CL:WHEN (CL:NOT (CL:EQ (FIFTH CLASSDEF) NULL))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    "extends " (%STRING-WRAPPER.WRAPPER-VALUE (FIFTH CLASSDEF)) " "))
  (CL:WHEN (CL:NOT (CL:EQ (NTH CLASSDEF 5) NIL))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    "implements ")
   (JAVA-OUTPUT-IMPLEMENTS-INTERFACES (NTH CLASSDEF 5)))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "{" EOL)
  (JAVA-BUMP-INDENT)
  (CL:LET* ((STATEMENT NULL) (ITER-001 (NTH CLASSDEF 6)))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-001 NIL)) DO
    (CL:PROGN (CL:SETQ STATEMENT (%%VALUE ITER-001))
     (CL:SETQ ITER-001 (%%REST ITER-001)))
    (JAVA-OUTPUT-STATEMENT STATEMENT)))
  (CL:WHEN EXCEPTIONCLASS?
   (JAVA-OUTPUT-EXCEPTION-CONSTRUCTOR
    (%STRING-WRAPPER.WRAPPER-VALUE (FOURTH CLASSDEF))))
  (CL:LET* ((STATEMENT NULL) (ITER-002 (NTH CLASSDEF 7)))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-002 NIL)) DO
    (CL:PROGN (CL:SETQ STATEMENT (%%VALUE ITER-002))
     (CL:SETQ ITER-002 (%%REST ITER-002)))
    (JAVA-OUTPUT-STATEMENT (JAVA-TRANSLATE-UNIT STATEMENT))
    (CL:SETF (%TRANSLATION-UNIT.TRANSLATION STATEMENT) NULL)
    (CL:SETF (%TRANSLATION-UNIT.CODE-REGISTER STATEMENT) NULL)))
  (CL:LET* ((STATEMENT NULL) (ITER-003 (NTH CLASSDEF 8)))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-003 NIL)) DO
    (CL:PROGN (CL:SETQ STATEMENT (%%VALUE ITER-003))
     (CL:SETQ ITER-003 (%%REST ITER-003)))
    (JAVA-OUTPUT-STATEMENT (JAVA-TRANSLATE-UNIT STATEMENT))
    (CL:SETF (%TRANSLATION-UNIT.TRANSLATION STATEMENT) NULL)
    (CL:SETF (%TRANSLATION-UNIT.CODE-REGISTER STATEMENT) NULL)))
  (JAVA-UNBUMP-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}" EOL
   EOL)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-EXCEPTION-CONSTRUCTOR ...)

(CL:DEFUN JAVA-OUTPUT-EXCEPTION-CONSTRUCTOR (EXCEPTIONNAME)
  (CL:DECLARE (CL:TYPE CL:SIMPLE-STRING EXCEPTIONNAME))
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   "public " EXCEPTIONNAME " (String message) {" EOL)
  (JAVA-BUMP-INDENT)
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   "super(message);" EOL)
  (JAVA-UNBUMP-INDENT)
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}" EOL
   EOL)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-NAMED-STATEMENT ...)

(CL:DEFUN JAVA-OUTPUT-NAMED-STATEMENT (NAMEDSTATEMENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE NAMEDSTATEMENT))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " : ")
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST NAMEDSTATEMENT)))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-FORMAL-PARAMETERS ...)

(CL:DEFUN JAVA-OUTPUT-FORMAL-PARAMETERS (PARAMETERS)
  (CL:LET* ((LASTPARAMETER NULL) (ALLBUTLASTPARAMETER NULL))
   (CL:MULTIPLE-VALUE-SETQ (ALLBUTLASTPARAMETER LASTPARAMETER)
    (JAVA-SEPARATE-LAST-CONS PARAMETERS))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "(")
   (CL:LET* ((PARAMETER NULL) (ITER-000 ALLBUTLASTPARAMETER))
    (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
     (CL:PROGN (CL:SETQ PARAMETER (%%VALUE ITER-000))
      (CL:SETQ ITER-000 (%%REST ITER-000)))
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
      (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE PARAMETER)) " "
      (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST PARAMETER))) ", ")))
   (CL:WHEN (CL:NOT (CL:EQ LASTPARAMETER NULL))
    (CL:LET* ((CASTEDLASTPARAMETER LASTPARAMETER))
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
      (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE CASTEDLASTPARAMETER)) " "
      (%STRING-WRAPPER.WRAPPER-VALUE
       (%%VALUE (%%REST CASTEDLASTPARAMETER))))))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")"))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-METHOD-SIGNATURE ...)

(CL:DEFUN JAVA-OUTPUT-METHOD-SIGNATURE (METHOD)
  (CL:LET* ((M NULL) (ITER-000 (%%VALUE METHOD)))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
    (CL:PROGN (CL:SETQ M (%%VALUE ITER-000))
     (CL:SETQ ITER-000 (%%REST ITER-000)))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     (%STRING-WRAPPER.WRAPPER-VALUE M) " ")))
  (JAVA-OUTPUT-TYPE-EXPRESSION (%%VALUE (%%REST METHOD)))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST (%%REST METHOD)))))
  (JAVA-OUTPUT-FORMAL-PARAMETERS (FOURTH METHOD))
  :VOID)

;;; (DEFUN (JAVA-SEPARATE-COMMENT-FROM-BODY CONS CONS) ...)

(CL:DEFUN JAVA-SEPARATE-COMMENT-FROM-BODY (BODY)
  (CL:IF
   (CL:AND (CL:EQ (%%VALUE BODY) SYM-JAVA-OUTPUT-STELLA-JAVA_STATEMENTS)
    (CL:NOT (CL:EQ (%%REST BODY) NIL))
    (ISA? (%%VALUE (%%REST BODY)) SGT-JAVA-OUTPUT-STELLA-CONS)
    (CL:EQ (%%VALUE (%%VALUE (%%REST BODY)))
     SYM-JAVA-OUTPUT-STELLA-JAVA_COMMENT))
   (CL:LET* ((COMMENT (%%VALUE (%%REST BODY))))
    (CL:SETF (%%REST BODY) (%%REST (%%REST BODY)))
    (CL:RETURN-FROM JAVA-SEPARATE-COMMENT-FROM-BODY
     (CL:VALUES BODY COMMENT)))
   (CL:RETURN-FROM JAVA-SEPARATE-COMMENT-FROM-BODY (CL:VALUES BODY NULL))))

;;; (DEFUN JAVA-OUTPUT-METHOD ...)

(CL:DEFUN JAVA-OUTPUT-METHOD (METHOD)
  (CL:LET* ((BODY NULL) (COMMENT NULL))
   (CL:MULTIPLE-VALUE-SETQ (BODY COMMENT)
    (JAVA-SEPARATE-COMMENT-FROM-BODY (FIFTH METHOD)))
   (JAVA-INDENT)
   (CL:WHEN (CL:NOT (CL:EQ COMMENT NULL))
    (JAVA-OUTPUT-JAVADOC-COMMENT (%%VALUE (%%REST COMMENT))
     (FOURTH METHOD) (%%VALUE (%%VALUE (%%REST METHOD)))
     STELLA::NULL-STRING STELLA::NULL-STRING))
   (JAVA-OUTPUT-METHOD-SIGNATURE METHOD)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " {"
    EOL)
   (JAVA-BUMP-INDENT) (JAVA-OUTPUT-STATEMENT (FIFTH METHOD))
   (JAVA-UNBUMP-INDENT) (JAVA-INDENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}"
    EOL)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) EOL))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(%%DEFCONSMETHOD JAVA-OUTPUT-LITERAL ((CONS CL:CONS))
  (CL:IF (CL:EQ CONS NIL)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "NIL")
   (CL:PROGN
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "("
     (%%VALUE CONS) " . ")
    (JAVA-OUTPUT-LITERAL (%%REST CONS))))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((TREE QUOTED-EXPRESSION))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "\""
   TREE "\"")
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((SYMBOL SYMBOL))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (JAVA-TRANSLATE-SYMBOL-NAME SYMBOL)))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((SURROGATE SURROGATE))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE
    (JAVA-TRANSLATE-SURROGATE-NAME SURROGATE)))
  :VOID)

;;; (DEFMETHOD JAVA-OUTPUT-LITERAL ...)

(CL:DEFMETHOD JAVA-OUTPUT-LITERAL ((KEYWORD KEYWORD))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (JAVA-TRANSLATE-KEYWORD-NAME KEYWORD)))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-TYPE-EXPRESSION ...)

(CL:DEFUN JAVA-OUTPUT-TYPE-EXPRESSION (TYPEEXPRESSION)
  (CL:LET* ((TYPEEXPR NULL) (ITER-000 TYPEEXPRESSION))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
    (CL:PROGN (CL:SETQ TYPEEXPR (%%VALUE ITER-000))
     (CL:SETQ ITER-000 (%%REST ITER-000)))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     (%STRING-WRAPPER.WRAPPER-VALUE TYPEEXPR) " ")))
  :VOID)

;;; (DEFGLOBAL *JAVA-SEMICOLON-STATEMENTS* ...)

(CL:DEFVAR *JAVA-SEMICOLON-STATEMENTS* NULL)

;;; (DEFUN (JAVA-OUTPUT-SEMICOLON? BOOLEAN) ...)

(CL:DEFUN JAVA-OUTPUT-SEMICOLON? (STATEMENT)
  (CL:IF (CL:NOT (CL:EQ STATEMENT NULL))
   (CL:RETURN-FROM JAVA-OUTPUT-SEMICOLON?
    (MEMBER? *JAVA-SEMICOLON-STATEMENTS* (%%VALUE STATEMENT)))
   (CL:RETURN-FROM JAVA-OUTPUT-SEMICOLON? FALSE)))

;;; (DEFUN (JAVA-INDENT-STATEMENT? BOOLEAN) ...)

(CL:DEFUN JAVA-INDENT-STATEMENT? (STATEMENT)
  (CL:IF (CL:NOT (CL:EQ STATEMENT NULL))
   (CL:RETURN-FROM JAVA-INDENT-STATEMENT?
    (CL:NOT
     (MEMBER?
      (GET-QUOTED-TREE "((JAVA_STATEMENTS JAVA_CATCH) \"/STELLA\")"
       "/STELLA")
      (%%VALUE STATEMENT))))
   (CL:RETURN-FROM JAVA-INDENT-STATEMENT? FALSE)))

;;; (DEFUN (JAVA-ILLEGAL-STATEMENT? BOOLEAN) ...)

(CL:DEFUN JAVA-ILLEGAL-STATEMENT? (STATEMENT)
  (CL:IF (CL:NOT (CL:EQ STATEMENT NULL))
   (CL:RETURN-FROM JAVA-ILLEGAL-STATEMENT?
    (MEMBER?
     (GET-QUOTED-TREE "((JAVA_LITERAL JAVA_IDENT) \"/STELLA\")" "/STELLA")
     (%%VALUE STATEMENT)))
   (CL:RETURN-FROM JAVA-ILLEGAL-STATEMENT? FALSE)))

;;; (DEFUN JAVA-OUTPUT-STATEMENTS ...)

(CL:DEFUN JAVA-OUTPUT-STATEMENTS (STATEMENTLIST)
  (CL:LET* ((STATEMENT NULL) (ITER-000 STATEMENTLIST))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
    (CL:PROGN (CL:SETQ STATEMENT (%%VALUE ITER-000))
     (CL:SETQ ITER-000 (%%REST ITER-000)))
    (CL:WHEN (CL:NOT (JAVA-ILLEGAL-STATEMENT? STATEMENT))
     (CL:WHEN (JAVA-INDENT-STATEMENT? STATEMENT) (JAVA-INDENT))
     (JAVA-OUTPUT-STATEMENT STATEMENT)
     (CL:WHEN (JAVA-OUTPUT-SEMICOLON? STATEMENT)
      (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";"
       EOL)))))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-DECLARATIONS ...)

(CL:DEFUN JAVA-OUTPUT-DECLARATIONS (DECLARATIONS)
  (JAVA-BUMP-INDENT)
  (CL:LET* ((DECLARATION NULL) (ITER-000 DECLARATIONS))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
    (CL:PROGN (CL:SETQ DECLARATION (%%VALUE ITER-000))
     (CL:SETQ ITER-000 (%%REST ITER-000)))
    (JAVA-INDENT) (JAVA-OUTPUT-TYPE-EXPRESSION (%%VALUE DECLARATION))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST DECLARATION))))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";"
     EOL)))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) EOL)
  (JAVA-UNBUMP-INDENT)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-COMMENT-STRING ...)

(CL:DEFUN JAVA-OUTPUT-COMMENT-STRING (COMMENT COMMENT-START COMMENT-CONTINUATION COMMENT-END)
  (CL:DECLARE
   (CL:TYPE CL:SIMPLE-STRING COMMENT COMMENT-START COMMENT-CONTINUATION
    COMMENT-END))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   COMMENT-START)
  (CL:LET* ((RETURNP FALSE))
   (CL:LET*
    ((CHAR NULL-CHARACTER) (VECTOR-000 COMMENT) (INDEX-000 0)
     (LENGTH-000 (CL:THE CL:FIXNUM (CL:LENGTH VECTOR-000))))
    (CL:DECLARE (CL:TYPE CL:SIMPLE-STRING VECTOR-000)
     (CL:TYPE CL:FIXNUM INDEX-000 LENGTH-000))
    (CL:LOOP WHILE (CL:< INDEX-000 LENGTH-000) DO
     (CL:PROGN
      (CL:SETQ CHAR
       (CL:LET ((SELF VECTOR-000) (POSITION INDEX-000))
        (CL:DECLARE (CL:TYPE CL:SIMPLE-STRING SELF)
         (CL:TYPE CL:FIXNUM POSITION))
        (CL:AREF (CL:THE CL:SIMPLE-STRING SELF)
         (CL:THE CL:FIXNUM POSITION))))
      (CL:SETQ INDEX-000 (CL:1+ INDEX-000)))
     (CL:CASE CHAR
      (#\Linefeed
       (CL:WHEN (CL:NOT RETURNP)
        (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
         EOL)
        (JAVA-INDENT)
        (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
         COMMENT-CONTINUATION))
       (CL:SETQ RETURNP FALSE))
      (#\Return
       (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
        EOL)
       (JAVA-INDENT)
       (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
        COMMENT-CONTINUATION)
       (CL:SETQ RETURNP TRUE))
      (CL:OTHERWISE
       (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
        CHAR)
       (CL:SETQ RETURNP FALSE)))))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) EOL)
   (CL:WHEN
    (CL:AND (CL:NOT (CL:EQ COMMENT-END STELLA::NULL-STRING))
     (CL:NOT (STRING-EQL? COMMENT-END "")))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     COMMENT-END EOL)))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-COMMENT ...)

(CL:DEFUN JAVA-OUTPUT-COMMENT (TREE)
  (JAVA-OUTPUT-COMMENT-STRING (%STRING-WRAPPER.WRAPPER-VALUE TREE) "// "
   "// " STELLA::NULL-STRING)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-JAVADOC-COMMENT ...)

(CL:DEFUN JAVA-OUTPUT-JAVADOC-COMMENT (TREE PARAMETERNAMES RETURNVALUE AUTHOR VERSION)
  (CL:DECLARE (CL:TYPE CL:SIMPLE-STRING AUTHOR VERSION))
  (JAVA-OUTPUT-COMMENT-STRING (%STRING-WRAPPER.WRAPPER-VALUE TREE) "/** "
   " * " STELLA::NULL-STRING)
  (CL:WHEN (CL:NOT (CL:EQ PARAMETERNAMES NULL))
   (CL:LET* ((N NULL) (ITER-000 PARAMETERNAMES))
    (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
     (CL:PROGN (CL:SETQ N (%%VALUE ITER-000))
      (CL:SETQ ITER-000 (%%REST ITER-000)))
     (JAVA-INDENT)
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
      " * @param " (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST N)))
      EOL))))
  (CL:WHEN
   (CL:AND (CL:NOT (CL:EQ RETURNVALUE NULL))
    (CL:NOT
     (STRING-EQL? (%STRING-WRAPPER.WRAPPER-VALUE RETURNVALUE) "void")))
   (JAVA-INDENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    " * @return " (%STRING-WRAPPER.WRAPPER-VALUE RETURNVALUE) EOL))
  (CL:WHEN
   (CL:AND (CL:NOT (CL:EQ AUTHOR STELLA::NULL-STRING))
    (CL:NOT (CL:EQ AUTHOR "")))
   (JAVA-INDENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    " * @author " AUTHOR EOL))
  (CL:WHEN
   (CL:AND (CL:NOT (CL:EQ VERSION STELLA::NULL-STRING))
    (CL:NOT (CL:EQ VERSION "")))
   (JAVA-INDENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    " * @version " VERSION EOL))
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " */"
   EOL)
  (JAVA-INDENT)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-VERBATIM ...)

(CL:DEFUN JAVA-OUTPUT-VERBATIM (VERBATIMSTATEMENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (SUBSTITUTE-TEMPLATE-VARIABLES-IN-STRING
    (%STRING-WRAPPER.WRAPPER-VALUE VERBATIMSTATEMENT)
    *JAVA-STELLA-PACKAGE-MAPPING*))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-MAKE ...)

(CL:DEFUN JAVA-OUTPUT-MAKE (STATEMENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "new ")
  (JAVA-OUTPUT-STATEMENT (%%VALUE STATEMENT))
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST STATEMENT)))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-CAST ...)

(CL:DEFUN JAVA-OUTPUT-CAST (TREE)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "(("
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST TREE))) ")(")
  (JAVA-OUTPUT-STATEMENT (%%VALUE TREE))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "))")
  :VOID)

;;; (DEFUN JAVA-OUTPUT-PROGN ...)

(CL:DEFUN JAVA-OUTPUT-PROGN (PROGN)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "{" EOL)
  (JAVA-BUMP-INDENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE PROGN))
  (JAVA-UNBUMP-INDENT)
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}" EOL)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-BLOCK ...)

(CL:DEFUN JAVA-OUTPUT-BLOCK (BLOCK)
  (CL:LET* ((FIRSTSTATEMENT? TRUE))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "{ ")
   (JAVA-BUMP-INDENT)
   (CL:LET* ((DECLARATION NULL) (ITER-000 (%%VALUE BLOCK)))
    (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
     (CL:PROGN (CL:SETQ DECLARATION (%%VALUE ITER-000))
      (CL:SETQ ITER-000 (%%REST ITER-000)))
     (CL:WHEN (CL:NOT FIRSTSTATEMENT?) (JAVA-INDENT))
     (CL:SETQ FIRSTSTATEMENT? FALSE)
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
      (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE DECLARATION)))
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " ")
     (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST DECLARATION)))
     (CL:WHEN
      (CL:NOT (CL:EQ (%%VALUE (%%REST (%%REST DECLARATION))) NULL))
      (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
       " = ")
      (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST (%%REST DECLARATION)))))
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";"
      EOL)))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) EOL)
   (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST BLOCK))) (JAVA-UNBUMP-INDENT)
   (JAVA-INDENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}"
    EOL))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-RETURN ...)

(CL:DEFUN JAVA-OUTPUT-RETURN (RETURNSTATEMENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "return")
  (CL:WHEN (CL:NOT (CL:EQ RETURNSTATEMENT NULL))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " (")
   (JAVA-OUTPUT-STATEMENT RETURNSTATEMENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")"))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-THROW ...)

(CL:DEFUN JAVA-OUTPUT-THROW (TREE)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   "throw new ")
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE TREE)))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-CATCH ...)

(CL:DEFUN JAVA-OUTPUT-CATCH (TREE)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   " catch (")
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%VALUE TREE))))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " ")
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST (%%VALUE TREE)))))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ") {"
   EOL)
  (JAVA-BUMP-INDENT)
  (JAVA-OUTPUT-STATEMENTS (%%REST TREE))
  (JAVA-UNBUMP-INDENT)
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}")
  :VOID)

;;; (DEFUN JAVA-OUTPUT-UNWIND-PROTECT ...)

(CL:DEFUN JAVA-OUTPUT-UNWIND-PROTECT (TREE)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "try {"
   EOL)
  (JAVA-BUMP-INDENT)
  (CL:COND
   ((JAVA-PROGN? (%%VALUE TREE))
    (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST (%%VALUE TREE)))))
   ((JAVA-INDENT-STATEMENT? (%%VALUE TREE)) (JAVA-INDENT)
    (JAVA-OUTPUT-STATEMENT (%%VALUE TREE))
    (CL:WHEN (JAVA-OUTPUT-SEMICOLON? (%%VALUE TREE))
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";"
      EOL)))
   (CL:T (JAVA-OUTPUT-STATEMENT (%%VALUE TREE))))
  (JAVA-UNBUMP-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) EOL)
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   "} finally {" EOL)
  (JAVA-BUMP-INDENT)
  (JAVA-OUTPUT-STATEMENTS (%%REST TREE))
  (JAVA-UNBUMP-INDENT)
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}" EOL)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-HANDLER-CASE ...)

(CL:DEFUN JAVA-OUTPUT-HANDLER-CASE (TREE)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "try {"
   EOL)
  (JAVA-BUMP-INDENT)
  (CL:IF (JAVA-PROGN? (%%VALUE TREE))
   (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST (%%VALUE TREE))))
   (CL:PROGN (JAVA-INDENT) (JAVA-OUTPUT-STATEMENT (%%VALUE TREE))
    (CL:WHEN (JAVA-OUTPUT-SEMICOLON? (%%VALUE TREE))
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";"
      EOL))))
  (JAVA-UNBUMP-INDENT)
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}")
  (JAVA-OUTPUT-STATEMENTS (%%REST TREE))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-SIGNAL ...)

(CL:DEFUN JAVA-OUTPUT-SIGNAL (TREE)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "throw ")
  (JAVA-OUTPUT-STATEMENT (%%VALUE TREE))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-GLOBAL-DEFINITION ...)

(CL:DEFUN JAVA-OUTPUT-GLOBAL-DEFINITION (GLOBAL)
  (JAVA-INDENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE GLOBAL))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST GLOBAL))))
  (CL:WHEN (CL:NOT (CL:EQ (%%REST (%%REST GLOBAL)) NIL))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " = ")
   (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST (%%REST GLOBAL)))))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";" EOL
   EOL)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-SPECIAL-DEFINITION ...)

(CL:DEFUN JAVA-OUTPUT-SPECIAL-DEFINITION (SPECIAL)
  (JAVA-INDENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE SPECIAL))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST SPECIAL))))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   " = new InheritableThreadLocal();" EOL EOL)
  (CL:WHEN (CL:NOT (CL:EQ (%%REST (%%REST SPECIAL)) NIL))
   (CL:LET* ((STREAM-000 (NEW-OUTPUT-STRING-STREAM)))
    (%%PRINT-STREAM (%OUTPUT-STRING-STREAM.NATIVE-STREAM STREAM-000)
     "Special variables in Java shouldn't have initial values:`" SPECIAL
     "'")
    (CL:ERROR (NEW-STELLA-EXCEPTION (THE-STRING-READER STREAM-000)))))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-ACTUALS-AS-CONS-EXPRESSION ...)

(CL:DEFUN JAVA-OUTPUT-ACTUALS-AS-CONS-EXPRESSION (ARGLIST)
  (CL:IF (CL:EQ ARGLIST NIL)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    (JAVA-PREPEND-GLOBAL-CLASS-NAME "NIL" *STELLA-MODULE*))
   (CL:PROGN
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     (LOOKUP *JAVA-STELLA-PACKAGE-MAPPING* (WRAP-STRING "STELLAROOT"))
     ".Stella_Object.cons(")
    (JAVA-OUTPUT-STATEMENT (%%VALUE ARGLIST))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ", ")
    (JAVA-OUTPUT-ACTUALS-AS-CONS-EXPRESSION (%%REST ARGLIST))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")")))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-FUNCALL ...)

(CL:DEFUN JAVA-OUTPUT-FUNCALL (FUNCALL)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (JAVA-YIELD-FULL-NATIVE-CLASS-NAME) ".funcall(")
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST FUNCALL)))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   ", null, new java.lang.Object [] ")
  (JAVA-OUTPUT-ARRAY (%%REST (%%VALUE (%%REST (%%REST FUNCALL)))))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")")
  :VOID)

;;; (DEFUN JAVA-OUTPUT-METHOD-CODE-CALL ...)

(CL:DEFUN JAVA-OUTPUT-METHOD-CODE-CALL (METHODCALL)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (JAVA-YIELD-FULL-NATIVE-CLASS-NAME) ".funcall(")
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST METHODCALL)))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ", ")
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST (%%REST METHODCALL))))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   ", new java.lang.Object []")
  (JAVA-OUTPUT-ARRAY (%%REST (FOURTH METHODCALL)))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")")
  :VOID)

;;; (DEFUN JAVA-OUTPUT-BREAK ...)

(CL:DEFUN JAVA-OUTPUT-BREAK (TAG)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "break ")
  (JAVA-OUTPUT-STATEMENT TAG)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";" EOL)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-CONTINUE ...)

(CL:DEFUN JAVA-OUTPUT-CONTINUE (TAG)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   "continue ")
  (JAVA-OUTPUT-STATEMENT TAG)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";" EOL)
  :VOID)

;;; (DEFUN (JAVA-STATEMENT-RETURNS? BOOLEAN) ...)

(CL:DEFUN JAVA-STATEMENT-RETURNS? (STATEMENT)
  (CL:COND
   ((CL:EQ STATEMENT NULL) (CL:RETURN-FROM JAVA-STATEMENT-RETURNS? FALSE))
   ((CL:EQ STATEMENT NIL) (CL:RETURN-FROM JAVA-STATEMENT-RETURNS? FALSE))
   (CL:T
    (CL:LET* ((TEST-VALUE-000 (%%VALUE STATEMENT)))
     (CL:COND
      ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_VERBATIM)
       (CL:RETURN-FROM JAVA-STATEMENT-RETURNS?
        (DEFINED?
         (STRING-SEARCH
          (%STRING-WRAPPER.WRAPPER-VALUE (%%VALUE (%%REST STATEMENT)))
          "throw new Error" 0))))
      ((CL:OR (CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_RETURN)
        (CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_CONTINUE)
        (CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_BREAK)
        (CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_SIGNAL))
       (CL:RETURN-FROM JAVA-STATEMENT-RETURNS? TRUE))
      ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_STATEMENTS)
       (CL:RETURN-FROM JAVA-STATEMENT-RETURNS?
        (JAVA-LAST-STATEMENT-RETURNS? (%%REST STATEMENT))))
      ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_PROGN)
       (CL:RETURN-FROM JAVA-STATEMENT-RETURNS?
        (JAVA-LAST-STATEMENT-RETURNS? (%%VALUE (%%REST STATEMENT)))))
      ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_BLOCK)
       (CL:RETURN-FROM JAVA-STATEMENT-RETURNS?
        (JAVA-LAST-STATEMENT-RETURNS?
         (%%VALUE (%%REST (%%REST STATEMENT))))))
      ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_IF)
       (CL:RETURN-FROM JAVA-STATEMENT-RETURNS?
        (CL:AND
         (JAVA-STATEMENT-RETURNS? (%%VALUE (%%REST (%%REST STATEMENT))))
         (JAVA-STATEMENT-RETURNS? (FOURTH STATEMENT)))))
      ((CL:EQ TEST-VALUE-000 SYM-JAVA-OUTPUT-STELLA-JAVA_COND)
       (CL:LET* ((TEST-VALUE-001 FALSE))
        (CL:SETQ TEST-VALUE-001
         (JAVA-STATEMENT-RETURNS? (%%VALUE (%%REST STATEMENT))))
        (CL:WHEN TEST-VALUE-001
         (CL:LET* ((ALWAYS?-000 TRUE))
          (CL:LET*
           ((C NULL) (ITER-000 (%%VALUE (%%REST (%%REST STATEMENT)))))
           (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
            (CL:PROGN (CL:SETQ C (%%VALUE ITER-000))
             (CL:SETQ ITER-000 (%%REST ITER-000)))
            (CL:WHEN (CL:NOT (JAVA-LAST-STATEMENT-RETURNS? C))
             (CL:SETQ ALWAYS?-000 FALSE) (CL:RETURN))))
          (CL:SETQ TEST-VALUE-001 ALWAYS?-000)))
        (CL:LET* ((VALUE-000 TEST-VALUE-001))
         (CL:RETURN-FROM JAVA-STATEMENT-RETURNS? VALUE-000))))
      (CL:T (CL:RETURN-FROM JAVA-STATEMENT-RETURNS? FALSE)))))))

;;; (DEFUN (JAVA-LAST-STATEMENT-RETURNS? BOOLEAN) ...)

(CL:DEFUN JAVA-LAST-STATEMENT-RETURNS? (STATEMENTS)
  (CL:LET* ((ALLBUTLASTITEM NULL) (LASTITEM NULL))
   (CL:MULTIPLE-VALUE-SETQ (ALLBUTLASTITEM LASTITEM)
    (SEPARATE-LAST-CONS (%%REST STATEMENTS)))
   (CL:RETURN-FROM JAVA-LAST-STATEMENT-RETURNS?
    (JAVA-STATEMENT-RETURNS? LASTITEM))))

;;; (DEFUN JAVA-OUTPUT-CASE ...)

(CL:DEFUN JAVA-OUTPUT-CASE (CASE)
  (CL:LET*
   ((KEYFORM (%%VALUE CASE)) (DEFAULTCASE (%%VALUE (%%REST CASE)))
    (CONDITIONS (%%VALUE (%%REST (%%REST CASE)))))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    "switch (")
   (JAVA-OUTPUT-STATEMENT KEYFORM)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ") {"
    EOL)
   (JAVA-BUMP-INDENT)
   (CL:LET* ((C NULL) (ITER-000 CONDITIONS))
    (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
     (CL:PROGN (CL:SETQ C (%%VALUE ITER-000))
      (CL:SETQ ITER-000 (%%REST ITER-000)))
     (CL:LET* ((CONDITION C))
      (CL:LET*
       ((COND NULL)
        (ITER-001
         (CL:IF (CONS? (%%VALUE (%%VALUE CONDITION))) (%%VALUE CONDITION)
          (CONS (%%VALUE CONDITION) NIL))))
       (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-001 NIL)) DO
        (CL:PROGN (CL:SETQ COND (%%VALUE ITER-001))
         (CL:SETQ ITER-001 (%%REST ITER-001)))
        (JAVA-INDENT)
        (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
         "case ")
        (JAVA-OUTPUT-STATEMENT COND)
        (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
         ": " EOL)))
      (JAVA-BUMP-INDENT)
      (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST CONDITION)))
      (JAVA-UNBUMP-INDENT)
      (CL:WHEN
       (CL:NOT
        (JAVA-LAST-STATEMENT-RETURNS? (%%VALUE (%%REST CONDITION))))
       (JAVA-INDENT)
       (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
        "break;" EOL)))))
   (CL:WHEN (CL:EQ DEFAULTCASE NULL)
    (CL:ERROR
     "Safety violation: INTERNAL ERROR: `java-output-case' expects an `otherwise' clause."))
   (JAVA-INDENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    "default:" EOL)
   (JAVA-BUMP-INDENT) (JAVA-OUTPUT-STATEMENT DEFAULTCASE)
   (JAVA-UNBUMP-INDENT)
   (CL:WHEN (CL:NOT (JAVA-LAST-STATEMENT-RETURNS? DEFAULTCASE))
    (JAVA-INDENT)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "break;" EOL))
   (JAVA-UNBUMP-INDENT) (JAVA-INDENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}"
    EOL))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-COND ...)

(CL:DEFUN JAVA-OUTPUT-COND (COND)
  (CL:LET*
   ((DEFAULTCONDITION (%%VALUE COND)) (CONDITIONS (%%VALUE (%%REST COND)))
    (FIRSTCONDITION (%%VALUE CONDITIONS))
    (RESTCONDITIONS (%%REST CONDITIONS)))
   (CL:WHEN
    (CL:AND (CL:NOT (CL:EQ DEFAULTCONDITION NULL)) (CL:EQ CONDITIONS NIL))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "if (true) ")
    (JAVA-OUTPUT-STATEMENT DEFAULTCONDITION)
    (CL:RETURN-FROM JAVA-OUTPUT-COND))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "if (")
   (JAVA-OUTPUT-STATEMENT (%%VALUE FIRSTCONDITION))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ") ")
   (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST FIRSTCONDITION)))
   (CL:LET* ((C NULL) (ITER-000 RESTCONDITIONS))
    (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
     (CL:PROGN (CL:SETQ C (%%VALUE ITER-000))
      (CL:SETQ ITER-000 (%%REST ITER-000)))
     (CL:LET* ((CONDITION C)) (JAVA-INDENT)
      (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
       "else if (")
      (JAVA-OUTPUT-STATEMENT (%%VALUE CONDITION))
      (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
       ") ")
      (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST CONDITION))))))
   (CL:WHEN (CL:NOT (CL:EQ DEFAULTCONDITION NULL)) (JAVA-INDENT)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "else ")
    (JAVA-OUTPUT-STATEMENT DEFAULTCONDITION)))
  :VOID)

;;; (DEFUN (JAVA-PROGN? BOOLEAN) ...)

(CL:DEFUN JAVA-PROGN? (TREE)
  (CL:RETURN-FROM JAVA-PROGN?
   (CL:AND (CONS? TREE)
    (CL:EQ (%%VALUE TREE) SYM-JAVA-OUTPUT-STELLA-JAVA_PROGN))))

;;; (DEFUN (JAVA-BLOCK? BOOLEAN) ...)

(CL:DEFUN JAVA-BLOCK? (TREE)
  (CL:RETURN-FROM JAVA-BLOCK?
   (CL:AND (CONS? TREE)
    (CL:EQ (%%VALUE TREE) SYM-JAVA-OUTPUT-STELLA-JAVA_BLOCK))))

;;; (DEFUN JAVA-OUTPUT-IF ...)

(CL:DEFUN JAVA-OUTPUT-IF (TREE)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "if (")
  (JAVA-OUTPUT-STATEMENT (%%VALUE TREE))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ") ")
  (CL:IF
   (CL:OR (JAVA-PROGN? (%%VALUE (%%REST TREE)))
    (JAVA-BLOCK? (%%VALUE (%%REST TREE))))
   (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST TREE)))
   (CL:PROGN
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) EOL)
    (JAVA-BUMP-INDENT) (JAVA-INDENT)
    (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST TREE)))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";"
     EOL)
    (JAVA-UNBUMP-INDENT)))
  (CL:WHEN (CL:NOT (CL:EQ (%%VALUE (%%REST (%%REST TREE))) NULL))
   (JAVA-INDENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    "else ")
   (CL:IF
    (CL:OR (JAVA-PROGN? (%%VALUE (%%REST (%%REST TREE))))
     (JAVA-BLOCK? (%%VALUE (%%REST (%%REST TREE)))))
    (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST (%%REST TREE))))
    (CL:PROGN
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) EOL)
     (JAVA-BUMP-INDENT) (JAVA-INDENT)
     (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST (%%REST TREE))))
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";"
      EOL)
     (JAVA-UNBUMP-INDENT))))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-WHEN ...)

(CL:DEFUN JAVA-OUTPUT-WHEN (TREE)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "if (")
  (JAVA-OUTPUT-STATEMENT (%%VALUE TREE))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ") {"
   EOL)
  (JAVA-BUMP-INDENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST TREE)))
  (JAVA-UNBUMP-INDENT)
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}" EOL)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-UNLESS ...)

(CL:DEFUN JAVA-OUTPUT-UNLESS (TREE)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "if (!(")
  (JAVA-OUTPUT-STATEMENT (%%VALUE TREE))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")) {"
   EOL)
  (JAVA-BUMP-INDENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST TREE)))
  (JAVA-UNBUMP-INDENT)
  (JAVA-INDENT)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}" EOL)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-ASSIGNMENT ...)

(CL:DEFUN JAVA-OUTPUT-ASSIGNMENT (ASSIGNMENT)
  (JAVA-OUTPUT-STATEMENT (%%VALUE ASSIGNMENT))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " = ")
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST ASSIGNMENT)))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-LOOP ...)

(CL:DEFUN JAVA-OUTPUT-LOOP (LOOP)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   "for (;;) ")
  (JAVA-OUTPUT-STATEMENT (%%VALUE LOOP))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-WHILE ...)

(CL:DEFUN JAVA-OUTPUT-WHILE (LOOP)
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   "while (")
  (JAVA-OUTPUT-STATEMENT (%%VALUE LOOP))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ") ")
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST LOOP)))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-FOREACH ...)

(CL:DEFUN JAVA-OUTPUT-FOREACH (LOOP)
  (CL:LET*
   ((CONTINUATIONTEST (%%VALUE LOOP))
    (NEXTASSIGNMENTS (%%VALUE (%%REST LOOP)))
    (BODY (%%VALUE (%%REST (%%REST LOOP)))))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    "while (")
   (JAVA-OUTPUT-STATEMENT CONTINUATIONTEST)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ") {"
    EOL)
   (JAVA-BUMP-INDENT) (JAVA-OUTPUT-STATEMENTS NEXTASSIGNMENTS)
   (JAVA-OUTPUT-STATEMENTS BODY) (JAVA-UNBUMP-INDENT) (JAVA-INDENT)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}"
    EOL))
  :VOID)

;;; (DEFUN (JAVA-END-OF-LINE-TOKEN? BOOLEAN) ...)

(CL:DEFUN JAVA-END-OF-LINE-TOKEN? (TOKEN)
  (CL:COND
   ((CL:EQ (SAFE-PRIMARY-TYPE TOKEN) SGT-JAVA-OUTPUT-STELLA-CONS)
    (CL:PROGN
     (CL:RETURN-FROM JAVA-END-OF-LINE-TOKEN?
      (CL:EQ (%%VALUE TOKEN) SYM-JAVA-OUTPUT-STELLA-JAVA_EOL))))
   (CL:T))
  (CL:RETURN-FROM JAVA-END-OF-LINE-TOKEN? FALSE))

;;; (DEFUN JAVA-OUTPUT-PRINT-STREAM ...)

(CL:DEFUN JAVA-OUTPUT-PRINT-STREAM (EXPS NATIVESTREAM?)
  (CL:LET* ((STREAM (%%VALUE EXPS)))
   (CL:LET* ((FOUND?-000 FALSE))
    (CL:LET* ((I NULL) (ITER-000 (BUT-LAST (%%REST EXPS))))
     (CL:LOOP WHILE (NEXT? ITER-000) DO
      (CL:SETQ I (%ITERATOR.VALUE ITER-000))
      (CL:WHEN (JAVA-END-OF-LINE-TOKEN? I) (CL:SETQ FOUND?-000 TRUE)
       (CL:RETURN))))
    (CL:LET* ((EMBEDDEDEOL? FOUND?-000) (PRINTITEMS NIL))
     (CL:WHEN EMBEDDEDEOL?
      (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "{"
       EOL)
      (JAVA-BUMP-INDENT))
     (CL:LET* ((IT (ALLOCATE-ITERATOR (%%REST EXPS))))
      (CL:LOOP WHILE (NEXT? IT) DO
       (CL:LET* ((ITEM (%CONS-ITERATOR.VALUE IT)))
        (CL:IF (JAVA-END-OF-LINE-TOKEN? ITEM)
         (CL:PROGN (CL:WHEN EMBEDDEDEOL? (JAVA-INDENT))
          (JAVA-HELP-OUTPUT-PRINT-STREAM STREAM (REVERSE PRINTITEMS)
           NATIVESTREAM? TRUE)
          (CL:WHEN EMBEDDEDEOL?
           (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
            ";" EOL))
          (CL:SETQ PRINTITEMS NIL))
         (CL:SETQ PRINTITEMS (CONS ITEM PRINTITEMS))))))
     (CL:WHEN (CL:NOT (CL:EQ PRINTITEMS NIL))
      (CL:WHEN EMBEDDEDEOL? (JAVA-INDENT))
      (JAVA-HELP-OUTPUT-PRINT-STREAM STREAM (REVERSE PRINTITEMS)
       NATIVESTREAM? FALSE)
      (CL:WHEN EMBEDDEDEOL?
       (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ";"
        EOL)))
     (CL:WHEN EMBEDDEDEOL? (JAVA-UNBUMP-INDENT) (JAVA-INDENT)
      (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "}"
       EOL)))))
  :VOID)

;;; (DEFUN JAVA-HELP-OUTPUT-PRINT-STREAM ...)

(CL:DEFUN JAVA-HELP-OUTPUT-PRINT-STREAM (STREAM EXPS NATIVESTREAM? ENDOFLINE?)
  (CL:COND
   ((CL:EQ STREAM SYM-JAVA-OUTPUT-STELLA-JAVA_STANDARD_OUT)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "java.lang.System.out"))
   ((CL:EQ STREAM SYM-JAVA-OUTPUT-STELLA-JAVA_STANDARD_ERROR)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
     "java.lang.System.err"))
   (CL:T (JAVA-OUTPUT-STATEMENT STREAM)
    (CL:WHEN (CL:NOT NATIVESTREAM?)
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
      ".native_stream"))))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
   (CL:IF ENDOFLINE? ".println(" ".print("))
  (JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES (%%VALUE EXPS))
  (CL:LET* ((E NULL) (ITER-000 (%%REST EXPS)))
   (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
    (CL:PROGN (CL:SETQ E (%%VALUE ITER-000))
     (CL:SETQ ITER-000 (%%REST ITER-000)))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " + ")
    (JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES E)))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")")
  :VOID)

;;; (DEFUN (JAVA-INDENTABLE-BINARY-OPERATOR? BOOLEAN) ...)

(CL:DEFUN JAVA-INDENTABLE-BINARY-OPERATOR? (OPERATOR)
  (CL:RETURN-FROM JAVA-INDENTABLE-BINARY-OPERATOR?
   (MEMBER? (GET-QUOTED-TREE "((\"||\" \"&&\") \"/STELLA\")" "/STELLA")
    OPERATOR)))

;;; (DEFUN (JAVA-BINARY-OPERATOR? BOOLEAN) ...)

(CL:DEFUN JAVA-BINARY-OPERATOR? (STATEMENT)
  (CL:RETURN-FROM JAVA-BINARY-OPERATOR?
   (CL:AND (CONS? STATEMENT)
    (CL:EQ SYM-JAVA-OUTPUT-STELLA-JAVA_BINARY_OP (%%VALUE STATEMENT)))))

;;; (DEFUN (JAVA-OPERATOR? BOOLEAN) ...)

(CL:DEFUN JAVA-OPERATOR? (STATEMENT)
  (CL:RETURN-FROM JAVA-OPERATOR?
   (CL:AND (CONS? STATEMENT)
    (MEMBER?
     (GET-QUOTED-TREE
      "((JAVA_UNARY_OP JAVA_BINARY_OP JAVA_TERNARY_OP JAVA_ASSIGN JAVA_SLOT_VALUE_SETTER) \"/STELLA\")"
      "/STELLA")
     (%%VALUE STATEMENT)))))

;;; (DEFUN JAVA-OUTPUT-UNARY-OPERATOR ...)

(CL:DEFUN JAVA-OUTPUT-UNARY-OPERATOR (EXPRESSION)
  (CL:LET* ((OP (%%VALUE EXPRESSION)) (ARG (%%VALUE (%%REST EXPRESSION))))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    (%STRING-WRAPPER.WRAPPER-VALUE OP))
   (JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES ARG))
  :VOID)

;;; (DEFUN JAVA-HELP-OUTPUT-BINARY-OPERATOR ...)

(CL:DEFUN JAVA-HELP-OUTPUT-BINARY-OPERATOR (EXPRESSION NESTLEVEL)
  (CL:DECLARE (CL:TYPE CL:FIXNUM NESTLEVEL))
  (CL:LET*
   ((ARG1 (%%VALUE EXPRESSION)) (OP (%%VALUE (%%REST EXPRESSION)))
    (ARG2 (%%VALUE (%%REST (%%REST EXPRESSION)))))
   (CL:WHEN (JAVA-OPERATOR? ARG1)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "("))
   (CL:IF (JAVA-BINARY-OPERATOR? OP)
    (JAVA-HELP-OUTPUT-BINARY-OPERATOR (%%REST ARG1) (CL:1+ NESTLEVEL))
    (JAVA-OUTPUT-STATEMENT ARG1))
   (CL:WHEN (JAVA-OPERATOR? ARG1)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")"))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " ")
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    (%STRING-WRAPPER.WRAPPER-VALUE OP))
   (CL:IF (JAVA-INDENTABLE-BINARY-OPERATOR? OP)
    (CL:PROGN
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) EOL)
     (JAVA-INDENT)
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
      "    ")
     (CL:LET*
      ((D NULL-INTEGER) (ITER-000 1) (UPPER-BOUND-000 NESTLEVEL)
       (UNBOUNDED?-000 (NULL? UPPER-BOUND-000)))
      (CL:DECLARE (CL:TYPE CL:FIXNUM ITER-000 UPPER-BOUND-000 D))
      (CL:LOOP WHILE
       (CL:OR UNBOUNDED?-000 (CL:<= ITER-000 UPPER-BOUND-000)) DO
       (CL:PROGN (CL:SETQ D ITER-000) (CL:SETQ ITER-000 (CL:1+ ITER-000)))
       (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
        " "))))
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " "))
   (CL:WHEN (JAVA-OPERATOR? ARG2)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "("))
   (CL:IF (JAVA-BINARY-OPERATOR? ARG2)
    (JAVA-HELP-OUTPUT-BINARY-OPERATOR (%%REST ARG2) (CL:1+ NESTLEVEL))
    (JAVA-OUTPUT-STATEMENT ARG2))
   (CL:WHEN (JAVA-OPERATOR? ARG2)
    (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")")))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-BINARY-OPERATOR ...)

(CL:DEFUN JAVA-OUTPUT-BINARY-OPERATOR (EXPRESSION)
  (JAVA-HELP-OUTPUT-BINARY-OPERATOR EXPRESSION 0)
  :VOID)

;;; (DEFUN JAVA-OUTPUT-TERNARY-OPERATOR ...)

(CL:DEFUN JAVA-OUTPUT-TERNARY-OPERATOR (EXPRESSION)
  (CL:LET*
   ((ARG1 (%%VALUE EXPRESSION)) (OP1 (%%VALUE (%%REST EXPRESSION)))
    (ARG2 (%%VALUE (%%REST (%%REST EXPRESSION))))
    (OP2 (FOURTH EXPRESSION)) (ARG3 (FIFTH EXPRESSION)))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "(")
   (JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES ARG1)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " ")
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    (%STRING-WRAPPER.WRAPPER-VALUE OP1))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " ")
   (JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES ARG2)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " ")
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
    (%STRING-WRAPPER.WRAPPER-VALUE OP2))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) " ")
   (JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES ARG3)
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")"))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-METHOD-CALL ...)

(CL:DEFUN JAVA-OUTPUT-METHOD-CALL (METHODCALL)
  (JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES
   (%%VALUE (%%REST (%%REST METHODCALL))))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ".")
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST METHODCALL)))
  (JAVA-OUTPUT-STATEMENT (FOURTH METHODCALL))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-FUNCTION-CALL ...)

(CL:DEFUN JAVA-OUTPUT-FUNCTION-CALL (FUNCTIONCALL)
  (JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES (%%VALUE FUNCTIONCALL))
  (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ".")
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST FUNCTIONCALL)))
  (JAVA-OUTPUT-STATEMENT (%%VALUE (%%REST (%%REST FUNCTIONCALL))))
  :VOID)

;;; (DEFUN JAVA-OUTPUT-ACTUAL-PARAMETERS ...)

(CL:DEFUN JAVA-OUTPUT-ACTUAL-PARAMETERS (PARAMETERS)
  (CL:LET* ((LASTPARAMETER NULL) (ALLBUTLASTPARAMETER NULL))
   (CL:MULTIPLE-VALUE-SETQ (ALLBUTLASTPARAMETER LASTPARAMETER)
    (SEPARATE-LAST-CONS PARAMETERS))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) "(")
   (CL:LET* ((PARAMETER NULL) (ITER-000 ALLBUTLASTPARAMETER))
    (CL:LOOP WHILE (CL:NOT (CL:EQ ITER-000 NIL)) DO
     (CL:PROGN (CL:SETQ PARAMETER (%%VALUE ITER-000))
      (CL:SETQ ITER-000 (%%REST ITER-000)))
     (JAVA-OUTPUT-STATEMENT PARAMETER)
     (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*)
      ", ")))
   (CL:WHEN (CL:NOT (CL:EQ LASTPARAMETER NULL))
    (JAVA-OUTPUT-STATEMENT LASTPARAMETER))
   (%%PRINT-STREAM (%OUTPUT-STREAM.NATIVE-STREAM *CURRENT-STREAM*) ")"))
  :VOID)

(CL:DEFUN HELP-STARTUP-JAVA-OUTPUT1 ()
  (CL:PROGN
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_CLASS
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_CLASS" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_EXCEPTION_CLASS
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_EXCEPTION_CLASS" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_NAMED_STATEMENT
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_NAMED_STATEMENT" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_STATEMENTS
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_STATEMENTS" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_IDENT
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_IDENT" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_EOL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_EOL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_LITERAL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_LITERAL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_COMMENT
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_COMMENT" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_SYMBOL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_SYMBOL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_CATCH
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_CATCH" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_THROW
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_THROW" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_UNWIND_PROTECT
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_UNWIND_PROTECT" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_HANDLER_CASE
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_HANDLER_CASE" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_SIGNAL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_SIGNAL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_VERBATIM
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_VERBATIM" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_CAST
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_CAST" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_GLOBAL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_GLOBAL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_SPECIAL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_SPECIAL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_TYPE
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_TYPE" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_PROGN
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_PROGN" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_BLOCK
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_BLOCK" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_RETURN
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_RETURN" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_MAKE
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_MAKE" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCALL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_FUNCALL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_CODE_CALL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_METHOD_CODE_CALL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_ASSIGN
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_ASSIGN" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_BREAK
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_BREAK" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_CONTINUE
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_CONTINUE" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_COND
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_COND" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_CASE
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_CASE" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_IF
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_IF" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_WHEN
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_WHEN" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_UNLESS
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_UNLESS" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_LOOP
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_LOOP" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_WHILE
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_WHILE" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_FOREACH
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_FOREACH" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_SLOT_VALUE
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_SLOT_VALUE" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_SLOT_VALUE_SETTER
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_SLOT_VALUE_SETTER" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_UNARY_OP
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_UNARY_OP" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_BINARY_OP
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_BINARY_OP" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_TERNARY_OP
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_TERNARY_OP" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION_CALL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_FUNCTION_CALL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_CALL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_METHOD_CALL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_ACTUALS
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_ACTUALS" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_MAKE_ARRAY
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_MAKE_ARRAY" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_ARRAY_INITIALIZER
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_ARRAY_INITIALIZER" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_ANONYMOUS_ARRAY
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_ANONYMOUS_ARRAY" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_AREF
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_AREF" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_METHOD" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_FUNCTION" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_PRINT_STREAM
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_PRINT_STREAM" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_PRINT_NATIVE_STREAM
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_PRINT_NATIVE_STREAM" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_DECLARATIONS
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_DECLARATIONS" NULL 0))
   (CL:SETQ SGT-JAVA-OUTPUT-STELLA-CONS
    (INTERN-RIGID-SYMBOL-WRT-MODULE "CONS" NULL 1))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION_POINTER
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_FUNCTION_POINTER" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_POINTER
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_METHOD_POINTER" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_SETTER_CALL
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_METHOD_SETTER_CALL" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_NEW
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_NEW" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_STANDARD_OUT
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_STANDARD_OUT" NULL 0))
   (CL:SETQ SYM-JAVA-OUTPUT-STELLA-JAVA_STANDARD_ERROR
    (INTERN-RIGID-SYMBOL-WRT-MODULE "JAVA_STANDARD_ERROR" NULL 0)))
  :VOID)

(CL:DEFUN HELP-STARTUP-JAVA-OUTPUT2 ()
  (CL:PROGN
   (DEFINE-FUNCTION-OBJECT "JAVA-STELLA-PACKAGE"
    "(DEFUN (JAVA-STELLA-PACKAGE STRING) ())"
    (CL:FUNCTION JAVA-STELLA-PACKAGE) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-PARSE-TREE"
    "(DEFUN JAVA-OUTPUT-PARSE-TREE ((CONSTREE CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-PARSE-TREE) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-BUMP-INDENT"
    "(DEFUN JAVA-BUMP-INDENT ())" (CL:FUNCTION JAVA-BUMP-INDENT) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-UNBUMP-INDENT"
    "(DEFUN JAVA-UNBUMP-INDENT ())" (CL:FUNCTION JAVA-UNBUMP-INDENT) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-INDENT" "(DEFUN JAVA-INDENT ())"
    (CL:FUNCTION JAVA-INDENT) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-STATEMENT"
    "(DEFUN JAVA-OUTPUT-STATEMENT ((STATEMENT OBJECT)))"
    (CL:FUNCTION JAVA-OUTPUT-STATEMENT) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES"
    "(DEFUN JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES ((STATEMENT OBJECT)))"
    (CL:FUNCTION JAVA-MAYBE-OUTPUT-STATEMENT-WITH-PARENTHESES) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-SEPARATE-LAST-CONS"
    "(DEFUN (JAVA-SEPARATE-LAST-CONS CONS OBJECT) ((CONSLIST CONS)))"
    (CL:FUNCTION JAVA-SEPARATE-LAST-CONS) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-IDENTIFIER"
    "(DEFUN JAVA-OUTPUT-IDENTIFIER ((IDENTIFIER STRING-WRAPPER)))"
    (CL:FUNCTION JAVA-OUTPUT-IDENTIFIER) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((OBJECT OBJECT)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((STRING STRING)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((STRING STRING-WRAPPER)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((STRING MUTABLE-STRING-WRAPPER)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((CHARACTER CHARACTER-WRAPPER)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((INT INTEGER-WRAPPER)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((FLOAT FLOAT-WRAPPER)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((BOOLEAN BOOLEAN-WRAPPER)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-MAKE-ARRAY"
    "(DEFUN JAVA-OUTPUT-MAKE-ARRAY ((STATEMENT CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-MAKE-ARRAY) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-ARRAY"
    "(DEFUN JAVA-OUTPUT-ARRAY ((ARRAYELEMENTS CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-ARRAY) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-ANONYMOUS-ARRAY"
    "(DEFUN JAVA-OUTPUT-ANONYMOUS-ARRAY ((STATEMENT CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-ANONYMOUS-ARRAY) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-AREF"
    "(DEFUN JAVA-OUTPUT-AREF ((STATEMENT CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-AREF) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-SLOT-VALUE"
    "(DEFUN JAVA-OUTPUT-SLOT-VALUE ((STATEMENT CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-SLOT-VALUE) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-SLOT-VALUE-SETTER"
    "(DEFUN JAVA-OUTPUT-SLOT-VALUE-SETTER ((STATEMENT CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-SLOT-VALUE-SETTER) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-IMPLEMENTS-INTERFACES"
    "(DEFUN JAVA-OUTPUT-IMPLEMENTS-INTERFACES ((INTERFACELIST CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-IMPLEMENTS-INTERFACES) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-CLASS"
    "(DEFUN JAVA-OUTPUT-CLASS ((CLASSDEF CONS) (EXCEPTIONCLASS? BOOLEAN)))"
    (CL:FUNCTION JAVA-OUTPUT-CLASS) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-EXCEPTION-CONSTRUCTOR"
    "(DEFUN JAVA-OUTPUT-EXCEPTION-CONSTRUCTOR ((EXCEPTIONNAME STRING)))"
    (CL:FUNCTION JAVA-OUTPUT-EXCEPTION-CONSTRUCTOR) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-NAMED-STATEMENT"
    "(DEFUN JAVA-OUTPUT-NAMED-STATEMENT ((NAMEDSTATEMENT CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-NAMED-STATEMENT) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-FORMAL-PARAMETERS"
    "(DEFUN JAVA-OUTPUT-FORMAL-PARAMETERS ((PARAMETERS CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-FORMAL-PARAMETERS) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-METHOD-SIGNATURE"
    "(DEFUN JAVA-OUTPUT-METHOD-SIGNATURE ((METHOD CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-METHOD-SIGNATURE) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-SEPARATE-COMMENT-FROM-BODY"
    "(DEFUN (JAVA-SEPARATE-COMMENT-FROM-BODY CONS CONS) ((BODY CONS)))"
    (CL:FUNCTION JAVA-SEPARATE-COMMENT-FROM-BODY) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-METHOD"
    "(DEFUN JAVA-OUTPUT-METHOD ((METHOD CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-METHOD) NULL)
   (DEFINE-METHOD-OBJECT "(DEFMETHOD JAVA-OUTPUT-LITERAL ((CONS CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((TREE QUOTED-EXPRESSION)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((SYMBOL SYMBOL)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((SURROGATE SURROGATE)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-METHOD-OBJECT
    "(DEFMETHOD JAVA-OUTPUT-LITERAL ((KEYWORD KEYWORD)))"
    (CL:FUNCTION JAVA-OUTPUT-LITERAL) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-TYPE-EXPRESSION"
    "(DEFUN JAVA-OUTPUT-TYPE-EXPRESSION ((TYPEEXPRESSION (CONS OF STRING-WRAPPER))))"
    (CL:FUNCTION JAVA-OUTPUT-TYPE-EXPRESSION) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-SEMICOLON?"
    "(DEFUN (JAVA-OUTPUT-SEMICOLON? BOOLEAN) ((STATEMENT CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-SEMICOLON?) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-INDENT-STATEMENT?"
    "(DEFUN (JAVA-INDENT-STATEMENT? BOOLEAN) ((STATEMENT CONS)))"
    (CL:FUNCTION JAVA-INDENT-STATEMENT?) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-ILLEGAL-STATEMENT?"
    "(DEFUN (JAVA-ILLEGAL-STATEMENT? BOOLEAN) ((STATEMENT CONS)))"
    (CL:FUNCTION JAVA-ILLEGAL-STATEMENT?) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-STATEMENTS"
    "(DEFUN JAVA-OUTPUT-STATEMENTS ((STATEMENTLIST CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-STATEMENTS) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-DECLARATIONS"
    "(DEFUN JAVA-OUTPUT-DECLARATIONS ((DECLARATIONS (CONS OF CONS))))"
    (CL:FUNCTION JAVA-OUTPUT-DECLARATIONS) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-COMMENT-STRING"
    "(DEFUN JAVA-OUTPUT-COMMENT-STRING ((COMMENT STRING) (COMMENT-START STRING) (COMMENT-CONTINUATION STRING) (COMMENT-END STRING)))"
    (CL:FUNCTION JAVA-OUTPUT-COMMENT-STRING) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-COMMENT"
    "(DEFUN JAVA-OUTPUT-COMMENT ((TREE STRING-WRAPPER)))"
    (CL:FUNCTION JAVA-OUTPUT-COMMENT) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-JAVADOC-COMMENT"
    "(DEFUN JAVA-OUTPUT-JAVADOC-COMMENT ((TREE STRING-WRAPPER) (PARAMETERNAMES (CONS OF (CONS OF STRING-WRAPPER))) (RETURNVALUE STRING-WRAPPER) (AUTHOR STRING) (VERSION STRING)))"
    (CL:FUNCTION JAVA-OUTPUT-JAVADOC-COMMENT) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-VERBATIM"
    "(DEFUN JAVA-OUTPUT-VERBATIM ((VERBATIMSTATEMENT STRING-WRAPPER)))"
    (CL:FUNCTION JAVA-OUTPUT-VERBATIM) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-MAKE"
    "(DEFUN JAVA-OUTPUT-MAKE ((STATEMENT CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-MAKE) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-CAST"
    "(DEFUN JAVA-OUTPUT-CAST ((TREE CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-CAST) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-PROGN"
    "(DEFUN JAVA-OUTPUT-PROGN ((PROGN CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-PROGN) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-BLOCK"
    "(DEFUN JAVA-OUTPUT-BLOCK ((BLOCK CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-BLOCK) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-RETURN"
    "(DEFUN JAVA-OUTPUT-RETURN ((RETURNSTATEMENT CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-RETURN) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-THROW"
    "(DEFUN JAVA-OUTPUT-THROW ((TREE CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-THROW) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-CATCH"
    "(DEFUN JAVA-OUTPUT-CATCH ((TREE CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-CATCH) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-UNWIND-PROTECT"
    "(DEFUN JAVA-OUTPUT-UNWIND-PROTECT ((TREE CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-UNWIND-PROTECT) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-HANDLER-CASE"
    "(DEFUN JAVA-OUTPUT-HANDLER-CASE ((TREE CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-HANDLER-CASE) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-SIGNAL"
    "(DEFUN JAVA-OUTPUT-SIGNAL ((TREE CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-SIGNAL) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-GLOBAL-DEFINITION"
    "(DEFUN JAVA-OUTPUT-GLOBAL-DEFINITION ((GLOBAL CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-GLOBAL-DEFINITION) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-SPECIAL-DEFINITION"
    "(DEFUN JAVA-OUTPUT-SPECIAL-DEFINITION ((SPECIAL CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-SPECIAL-DEFINITION) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-ACTUALS-AS-CONS-EXPRESSION"
    "(DEFUN JAVA-OUTPUT-ACTUALS-AS-CONS-EXPRESSION ((ARGLIST CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-ACTUALS-AS-CONS-EXPRESSION) NULL)
   (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-FUNCALL"
    "(DEFUN JAVA-OUTPUT-FUNCALL ((FUNCALL CONS)))"
    (CL:FUNCTION JAVA-OUTPUT-FUNCALL) NULL))
  :VOID)

(CL:DEFUN STARTUP-JAVA-OUTPUT ()
  (CL:LET* ((*MODULE* *STELLA-MODULE*) (*CONTEXT* *MODULE*))
   (CL:DECLARE (CL:SPECIAL *MODULE* *CONTEXT*))
   (CL:WHEN (CURRENT-STARTUP-TIME-PHASE? 2) (HELP-STARTUP-JAVA-OUTPUT1)
    (CL:SETQ SYM-JAVA-OUTPUT-STELLA-STARTUP-JAVA-OUTPUT
     (INTERN-RIGID-SYMBOL-WRT-MODULE "STARTUP-JAVA-OUTPUT" NULL 0))
    (CL:SETQ SYM-JAVA-OUTPUT-STELLA-METHOD-STARTUP-CLASSNAME
     (INTERN-RIGID-SYMBOL-WRT-MODULE "METHOD-STARTUP-CLASSNAME" NULL 0)))
   (CL:WHEN (CURRENT-STARTUP-TIME-PHASE? 4)
    (CL:SETQ *JAVA-STELLA-PACKAGE-MAPPING* (NEW-KEY-VALUE-LIST))
    (CL:SETQ *JAVA-SEMICOLON-STATEMENTS*
     (LIST* SYM-JAVA-OUTPUT-STELLA-JAVA_ASSIGN
      SYM-JAVA-OUTPUT-STELLA-JAVA_UNARY_OP
      SYM-JAVA-OUTPUT-STELLA-JAVA_BINARY_OP
      SYM-JAVA-OUTPUT-STELLA-JAVA_TERNARY_OP
      SYM-JAVA-OUTPUT-STELLA-JAVA_CAST SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCALL
      SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION_CALL
      SYM-JAVA-OUTPUT-STELLA-JAVA_FUNCTION_POINTER
      SYM-JAVA-OUTPUT-STELLA-JAVA_MAKE
      SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_CALL
      SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_CODE_CALL
      SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_POINTER
      SYM-JAVA-OUTPUT-STELLA-JAVA_METHOD_SETTER_CALL
      SYM-JAVA-OUTPUT-STELLA-JAVA_NEW
      SYM-JAVA-OUTPUT-STELLA-JAVA_PRINT_NATIVE_STREAM
      SYM-JAVA-OUTPUT-STELLA-JAVA_PRINT_STREAM
      SYM-JAVA-OUTPUT-STELLA-JAVA_RETURN
      SYM-JAVA-OUTPUT-STELLA-JAVA_SIGNAL
      SYM-JAVA-OUTPUT-STELLA-JAVA_SLOT_VALUE_SETTER
      SYM-JAVA-OUTPUT-STELLA-JAVA_THROW
      SYM-JAVA-OUTPUT-STELLA-JAVA_VERBATIM NIL)))
   (CL:WHEN (CURRENT-STARTUP-TIME-PHASE? 6) (FINALIZE-CLASSES))
   (CL:WHEN (CURRENT-STARTUP-TIME-PHASE? 7) (HELP-STARTUP-JAVA-OUTPUT2)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-METHOD-CODE-CALL"
     "(DEFUN JAVA-OUTPUT-METHOD-CODE-CALL ((METHODCALL CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-METHOD-CODE-CALL) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-BREAK"
     "(DEFUN JAVA-OUTPUT-BREAK ((TAG CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-BREAK) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-CONTINUE"
     "(DEFUN JAVA-OUTPUT-CONTINUE ((TAG CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-CONTINUE) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-STATEMENT-RETURNS?"
     "(DEFUN (JAVA-STATEMENT-RETURNS? BOOLEAN) ((STATEMENT CONS)))"
     (CL:FUNCTION JAVA-STATEMENT-RETURNS?) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-LAST-STATEMENT-RETURNS?"
     "(DEFUN (JAVA-LAST-STATEMENT-RETURNS? BOOLEAN) ((STATEMENTS CONS)))"
     (CL:FUNCTION JAVA-LAST-STATEMENT-RETURNS?) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-CASE"
     "(DEFUN JAVA-OUTPUT-CASE ((CASE CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-CASE) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-COND"
     "(DEFUN JAVA-OUTPUT-COND ((COND CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-COND) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-PROGN?"
     "(DEFUN (JAVA-PROGN? BOOLEAN) ((TREE OBJECT)))"
     (CL:FUNCTION JAVA-PROGN?) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-BLOCK?"
     "(DEFUN (JAVA-BLOCK? BOOLEAN) ((TREE OBJECT)))"
     (CL:FUNCTION JAVA-BLOCK?) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-IF"
     "(DEFUN JAVA-OUTPUT-IF ((TREE CONS)))" (CL:FUNCTION JAVA-OUTPUT-IF)
     NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-WHEN"
     "(DEFUN JAVA-OUTPUT-WHEN ((TREE CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-WHEN) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-UNLESS"
     "(DEFUN JAVA-OUTPUT-UNLESS ((TREE CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-UNLESS) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-ASSIGNMENT"
     "(DEFUN JAVA-OUTPUT-ASSIGNMENT ((ASSIGNMENT CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-ASSIGNMENT) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-LOOP"
     "(DEFUN JAVA-OUTPUT-LOOP ((LOOP CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-LOOP) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-WHILE"
     "(DEFUN JAVA-OUTPUT-WHILE ((LOOP CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-WHILE) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-FOREACH"
     "(DEFUN JAVA-OUTPUT-FOREACH ((LOOP CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-FOREACH) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-END-OF-LINE-TOKEN?"
     "(DEFUN (JAVA-END-OF-LINE-TOKEN? BOOLEAN) ((TOKEN OBJECT)))"
     (CL:FUNCTION JAVA-END-OF-LINE-TOKEN?) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-PRINT-STREAM"
     "(DEFUN JAVA-OUTPUT-PRINT-STREAM ((EXPS CONS) (NATIVESTREAM? BOOLEAN)))"
     (CL:FUNCTION JAVA-OUTPUT-PRINT-STREAM) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-HELP-OUTPUT-PRINT-STREAM"
     "(DEFUN JAVA-HELP-OUTPUT-PRINT-STREAM ((STREAM OBJECT) (EXPS CONS) (NATIVESTREAM? BOOLEAN) (ENDOFLINE? BOOLEAN)))"
     (CL:FUNCTION JAVA-HELP-OUTPUT-PRINT-STREAM) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-INDENTABLE-BINARY-OPERATOR?"
     "(DEFUN (JAVA-INDENTABLE-BINARY-OPERATOR? BOOLEAN) ((OPERATOR STRING-WRAPPER)))"
     (CL:FUNCTION JAVA-INDENTABLE-BINARY-OPERATOR?) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-BINARY-OPERATOR?"
     "(DEFUN (JAVA-BINARY-OPERATOR? BOOLEAN) ((STATEMENT OBJECT)))"
     (CL:FUNCTION JAVA-BINARY-OPERATOR?) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OPERATOR?"
     "(DEFUN (JAVA-OPERATOR? BOOLEAN) ((STATEMENT OBJECT)))"
     (CL:FUNCTION JAVA-OPERATOR?) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-UNARY-OPERATOR"
     "(DEFUN JAVA-OUTPUT-UNARY-OPERATOR ((EXPRESSION CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-UNARY-OPERATOR) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-HELP-OUTPUT-BINARY-OPERATOR"
     "(DEFUN JAVA-HELP-OUTPUT-BINARY-OPERATOR ((EXPRESSION CONS) (NESTLEVEL INTEGER)))"
     (CL:FUNCTION JAVA-HELP-OUTPUT-BINARY-OPERATOR) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-BINARY-OPERATOR"
     "(DEFUN JAVA-OUTPUT-BINARY-OPERATOR ((EXPRESSION CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-BINARY-OPERATOR) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-TERNARY-OPERATOR"
     "(DEFUN JAVA-OUTPUT-TERNARY-OPERATOR ((EXPRESSION CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-TERNARY-OPERATOR) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-METHOD-CALL"
     "(DEFUN JAVA-OUTPUT-METHOD-CALL ((METHODCALL CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-METHOD-CALL) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-FUNCTION-CALL"
     "(DEFUN JAVA-OUTPUT-FUNCTION-CALL ((FUNCTIONCALL CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-FUNCTION-CALL) NULL)
    (DEFINE-FUNCTION-OBJECT "JAVA-OUTPUT-ACTUAL-PARAMETERS"
     "(DEFUN JAVA-OUTPUT-ACTUAL-PARAMETERS ((PARAMETERS CONS)))"
     (CL:FUNCTION JAVA-OUTPUT-ACTUAL-PARAMETERS) NULL)
    (DEFINE-FUNCTION-OBJECT "STARTUP-JAVA-OUTPUT"
     "(DEFUN STARTUP-JAVA-OUTPUT () :PUBLIC? TRUE)"
     (CL:FUNCTION STARTUP-JAVA-OUTPUT) NULL)
    (CL:LET*
     ((FUNCTION
       (LOOKUP-FUNCTION SYM-JAVA-OUTPUT-STELLA-STARTUP-JAVA-OUTPUT)))
     (SET-DYNAMIC-SLOT-VALUE (%METHOD-SLOT.DYNAMIC-SLOTS FUNCTION)
      SYM-JAVA-OUTPUT-STELLA-METHOD-STARTUP-CLASSNAME
      (WRAP-STRING "Startup-Java-Output") NULL-STRING-WRAPPER)))
   (CL:WHEN (CURRENT-STARTUP-TIME-PHASE? 8) (FINALIZE-SLOTS)
    (CLEANUP-UNFINALIZED-CLASSES))
   (CL:WHEN (CURRENT-STARTUP-TIME-PHASE? 9)
    (DEFINE-STELLA-GLOBAL-VARIABLE-FROM-STRINGIFIED-SOURCE
     "(DEFSPECIAL *JAVA-INDENT-CHARS* INTEGER 0)")
    (DEFINE-STELLA-GLOBAL-VARIABLE-FROM-STRINGIFIED-SOURCE
     "(DEFGLOBAL *JAVA-STELLA-PACKAGE-MAPPING* (KEY-VALUE-LIST OF STRING-WRAPPER STRING-WRAPPER) (NEW (KEY-VALUE-LIST OF STRING-WRAPPER STRING-WRAPPER)))")
    (DEFINE-STELLA-GLOBAL-VARIABLE-FROM-STRINGIFIED-SOURCE
     "(DEFGLOBAL *JAVA-SEMICOLON-STATEMENTS* (CONS OF SYMBOL) (BQUOTE (JAVA_ASSIGN JAVA_UNARY_OP JAVA_BINARY_OP JAVA_TERNARY_OP JAVA_CAST JAVA_FUNCALL JAVA_FUNCTION_CALL JAVA_FUNCTION_POINTER JAVA_MAKE JAVA_METHOD_CALL JAVA_METHOD_CODE_CALL JAVA_METHOD_POINTER JAVA_METHOD_SETTER_CALL JAVA_NEW JAVA_PRINT_NATIVE_STREAM JAVA_PRINT_STREAM JAVA_RETURN JAVA_SIGNAL JAVA_SLOT_VALUE_SETTER JAVA_THROW JAVA_VERBATIM)))")))
  :VOID)
